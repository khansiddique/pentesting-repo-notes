# Recon-ng
Recon-NG Tutorial - https://hackertarget.com/recon-ng-tutorial/

```
./recon-ng
help
workspaces create example_name 
marketplace help
marketplace search
marketplace search ssl
marketplace info ssltools 
marketplace install hackertarget
modules load hackertarget
help
show options
options set SOURCE tesla.com
info
input
run
show hosts
> # Add API keys to Recon-ng
keys add 
keys add shodan_api bbexampleapikey33
```

> Recon-ng modules - Modules are grouped together under various categories and can be found searching on marketplace
- discovery
- exploitation
- import
- recon
- reporting

---   
# Network Discover:

sudo arp-scan -l
or
netdiscover -r 10.0.2.1/24 -i eth0

or
netdiscover -i eth1 -r 192.168.47.0/24

or

netdiscover -i vboxnet0

![net-discover](https://github.com/khansiddique/pentesting-repo-notes/blob/main/Images/net-discover.png)

---

# Nmap:
```sh
> Version + Service + Operating System + Script Scan 
nmap -sV -sC --script vuln -oN blue.nmap 10.10.73.63
nmap -sV -A 192.168.1.8
nmap --script-updatedb
nmap --script <script_name> <target>
nmap --script http-title.nse 10.0.200.10
nmap -p 21 192.168.147.132 --script "ftp-*"
nmap --script ssh-brute --script-args userdb=users.txt,passdb=passwords.txt 10.0.200.10
nmap --script ssh-brute --script-args-file /home/attacker/script-args.txt

> Vulnerability Scan + NSE-Scripts
nmap --script vuln 10.0.200.3
nmap --script=vuln 10.0.200.3
nmap -sV -A --script vuln 192.168.1.8
or
nmap â€“sC 10.0.200.3

nmap -sC -sV -p 80 --script http-enum 10.10.1.34
nmap -sC -sV -p 80 --script http-enum testhtml5.vulnweb.com
or
# The following command NOT works for me: 
nmap -sC -sV -p 80 --script=http-enum 192.168.95.131

> SMB (SMB has two ports, 445 and 139.)
nmap --script smb-os-discovery.nse example.com
nmap --script=smb-enum-shares 192.168.1.1
# SMB Enumeration: 
nmap -p 445 --script=smb-enum-shares.nse,smb-enum-users.nse 10.10.42.255

> DNS
nmap --script=dns-brute example.com
nmap --script dns-zone-transfer.nse --script-args dns-zone-transfer.domain=example.com

> FTP
nmap --script=ftp-anon 192.168.1.1
nmap -p 21 --script "ftp-*" 192.168.56.4
> SMTP
nmap --script=smtp-enum-users --script-args smtp.domain=mail.example.com

nmap --script=vulners --script-args mincvss=5.0 example.com

> SNMP
nmap --script=snmp-brute 192.168.1.1

> CVE
nmap --script=http-vuln-cve2017-8917 example.com

> NFS Enumeration:
nmap -p 111 --script=nfs-ls,nfs-statfs,nfs-showmount 10.10.42.255

> MySQL Enumeration:
nmap --script=mysql-enum <target>
> Aggresive scan + Timing Measurement
$nmap -A -T4 scanme.nmap.org d0ze
$nmap 10.1.0.1 -A

> Top 10 ports scan
$ nmap -sS 192.168.56.1/24 --top-ports 10



```
> like Nessus or OpenVAS against a server

This result was produced by using the command `"nmap -script=vuln -p139,445 192.168.0.18"`. The `--script=vuln` option indicates that Nmap should use the Nmap Scripting Engine (NSE) script for vulnerability detection against the specified target.

https://www.stationx.net/nmap-scripts/

---
```sh
nmap -sT -p- 10.10.91.123
sudo nmap -sS -A -O -sV -p21,22,80,111,2049,34495,49606,55048,60604 10.10.91.123
nmap --min-rate 4000 -p- 10.10.16.106

```
---


### Nmap Commands

| Command | Description |
| --- | --- |
| nmap -sP 10.0.0.0/24  | Nmap scan the network, listing machines that respond to ping. |
| nmap -p 1-65535 -sV -sS -T4 target | A full TCP port scan using with service version detection - T1-T5 is the speed of the scan. |
| nmap -v -sS -A -T4 target | Prints verbose output, runs stealth syn scan, T4 timing, OS and version detection + traceroute and scripts against target services.|
| nmap -v -sS -A -T5 target | Prints verbose output, runs stealth syn scan, T5 timing, OS and version detection + traceroute and scripts against target services. |
| nmap -v -sV -O -sS -T5 target | Prints verbose output, runs stealth syn scan, T5 timing, OS and version detection. |
| nmap -v -p 1-65535 -sV -O -sS -T4 target | Prints verbose output, runs stealth syn scan, T4 timing, OS and version detection + full port range scan. |
| nmap -v -p 1-65535 -sV -O -sS -T5 target | Prints verbose output, runs stealth syn scan, T5 timing, OS and version detection + full port range scan. |


### Nmap scan from file

| Command | Description |
| --- | --- |
| nmap -iL ip-addresses.txt | Scans a list of IP addresses, you can add options before / after. |


### Nmap Scan all Ports

| Command | Description |
| --- | --- |
| nmap -p- target | Nmap scan all ports, a full scan of all TCP ports on a target. |


### Nmap output formats

| Command | Description |
| --- | --- |
| nmap -sS -sV -T5 10.0.1.99 -oA output-all-formats | nmap output to all formats. |
| nmap -sV -p 139,445 -oG grep-output.txt 10.0.1.0/24 | Outputs "grepable" output to a file, in this example Netbios servers. E.g, The output file could be grepped for "Open". |
| nmap -sS -sV -T5 10.0.1.99 --webxml -oX - \| xsltproc --output file.html - | Export nmap output to HTML report.  |

### Nmap Netbios Examples

| Command | Description |
| --- | --- |
| nmap -sV -v -p 139,445 10.0.0.1/24 | Find all Netbios servers on subnet |
| nmap -sU --script nbstat.nse -p 137 target | Nmap display Netbios name |
| nmap --script-args=unsafe=1 --script smb-check-vulns.nse -p 445 target | Nmap check if Netbios servers are vulnerable to MS08-067 |

### FTP : Anonymous login - Automated 

| Command | Description |
| --- | --- |
| nmap --script ftp-* -p 21 <ip> | Anon login and bounce FTP checks are perform by default by nmap with -sC option or: |

---
